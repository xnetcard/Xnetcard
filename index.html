<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ID Card Generator v4.2</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .card {
      width: 90mm;
      height: 60mm;
      background: white;
      border: 2px solid #1b5e20;
      border-radius: 8px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      padding: 8px;
    }

    .watermark {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0.08;
      font-size: 18mm;
      color: #1b5e20;
      text-align: center;
      white-space: nowrap;
      z-index: 0;
    }

    .photo {
      width: 25mm;
      height: 30mm;
      border: 1px solid #444;
      object-fit: cover;
      margin-right: 10px;
    }

    .header {
      display: flex;
      align-items: center;
      margin-bottom: 6px;
    }

    .college-info {
      text-align: left;
      flex: 1;
    }

    .college-info h2 {
      font-size: 14px;
      margin: 0;
      color: #1b5e20;
    }

    .info {
      font-size: 10px;
      margin-bottom: 2px;
    }

    .signature {
      font-family: "Brush Script MT", cursive;
      font-size: 14px;
      color: #1b5e20;
      text-align: right;
      margin-top: 8px;
      margin-right: 4px;
    }

    .buttons {
      margin-top: 10px;
    }

    input,
    button {
      margin: 4px;
      padding: 6px;
    }

    #previewSection {
      display: none;
      flex-direction: column;
      align-items: center;
    }
  </style>
</head>
<body>
  <h2>ðŸŽ“ College ID Card Generator (v4.2)</h2>

  <!-- Form Section -->
  <div id="formSection">
    <input type="text" id="collegeName" placeholder="College Name" /><br />
    <input type="text" id="studentName" placeholder="Student Name" /><br />
    <input type="text" id="fatherName" placeholder="Father's Name" /><br />
    <input type="text" id="dob" placeholder="Date of Birth" /><br />
    <input type="text" id="address" placeholder="Address" /><br />
    <input type="text" id="mobile" placeholder="Mobile Number" /><br />
    <input type="text" id="regNo" placeholder="Registration No" /><br />
    <input type="text" id="principalName" placeholder="Principal Name" /><br /><br />

    <label>Upload Student Photo:</label><br />
    <input type="file" id="studentPhoto" accept="image/*" /><br /><br />

    <label>Upload College Logo (optional):</label><br />
    <input type="file" id="collegeLogo" accept="image/*" /><br /><br />

    <button onclick="generatePreview()">Preview Card</button>
  </div>

  <!-- Preview Section -->
  <div id="previewSection">
    <div class="card" id="idCard">
      <div class="watermark" id="watermark"></div>
      <div class="header">
        <img id="photoPreview" class="photo" alt="Student Photo" />
        <div class="college-info">
          <h2 id="collegeNamePreview"></h2>
          <div class="info" id="studentNamePreview"></div>
          <div class="info" id="fatherNamePreview"></div>
          <div class="info" id="dobPreview"></div>
          <div class="info" id="addressPreview"></div>
          <div class="info" id="mobilePreview"></div>
          <div class="info" id="regNoPreview"></div>
        </div>
      </div>
      <div class="signature" id="signaturePreview"></div>
    </div>

    <div class="buttons">
      <button onclick="downloadCard()">Download PNG</button>
      <button onclick="downloadPDF()">Download PDF</button>
      <button onclick="location.reload()">Create New</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function generatePreview() {
      const name = document.getElementById("studentName").value;
      const father = document.getElementById("fatherName").value;
      const dob = document.getElementById("dob").value;
      const address = document.getElementById("address").value;
      const mobile = document.getElementById("mobile").value;
      const regNo = document.getElementById("regNo").value;
      const college = document.getElementById("collegeName").value;
      const principal = document.getElementById("principalName").value;

      document.getElementById("collegeNamePreview").textContent = college;
      document.getElementById("studentNamePreview").textContent = "Name: " + name;
      document.getElementById("fatherNamePreview").textContent =
        "Father: " + father;
      document.getElementById("dobPreview").textContent = "DOB: " + dob;
      document.getElementById("addressPreview").textContent =
        "Address: " + address;
      document.getElementById("mobilePreview").textContent =
        "Mobile: " + mobile;
      document.getElementById("regNoPreview").textContent =
        "Reg. No: " + regNo;
      document.getElementById("signaturePreview").textContent = principal
        ? principal + " (Principal)"
        : "";
      document.getElementById("watermark").textContent = college;

      // Student photo
      const photoInput = document.getElementById("studentPhoto");
      if (photoInput.files && photoInput.files[0]) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById("photoPreview").src = e.target.result;
        };
        reader.readAsDataURL(photoInput.files[0]);
      }

      // Logo watermark
      const logoInput = document.getElementById("collegeLogo");
      if (logoInput.files && logoInput.files[0]) {
        const reader = new FileReader();
        reader.onload = (e) => {
          const watermark = document.getElementById("watermark");
          watermark.style.backgroundImage = `url('${e.target.result}')`;
          watermark.style.backgroundSize = "contain";
          watermark.style.backgroundRepeat = "no-repeat";
          watermark.style.backgroundPosition = "center";
          watermark.textContent = "";
        };
        reader.readAsDataURL(logoInput.files[0]);
      }

      document.getElementById("formSection").style.display = "none";
      document.getElementById("previewSection").style.display = "flex";
    }

    function downloadCard() {
      html2canvas(document.getElementById("idCard")).then((canvas) => {
        const link = document.createElement("a");
        link.download = "id_card.png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    async function downloadPDF() {
      const card = document.getElementById("idCard");
      const canvas = await html2canvas(card);
      const imgData = canvas.toDataURL("image/png");

      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: "landscape",
        unit: "mm",
        format: [90, 60],
      });

      pdf.addImage(imgData, "PNG", 0, 0, 90, 60);
      pdf.save("id_card.pdf");
    }
  </script>
</body>
  </html>
